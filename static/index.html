<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SHL Assessment Recommender</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; }
    h1 { color: #003087; }
    textarea { width: 100%; height: 120px; padding: 10px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px; }
    button { margin-top: 10px; padding: 10px 24px; background: #003087; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 15px; }
    button:hover { background: #0056b3; }
    #results { margin-top: 30px; }
    .card { border: 1px solid #ddd; border-radius: 6px; padding: 16px; margin-bottom: 12px; }
    .card h3 { margin: 0 0 8px; color: #003087; }
    .tag { display: inline-block; background: #e8f0fe; color: #003087; padding: 2px 8px; border-radius: 12px; font-size: 12px; margin-right: 4px; }
    .loading { color: #666; font-style: italic; }
    a { color: #0056b3; }
  </style>
</head>
<body>
  <h1>SHL Assessment Recommender</h1>
  <p>Enter a job description, natural language query, or paste a JD URL.</p>
  <textarea id="query" placeholder="e.g. I am hiring Java developers who collaborate with business teams..."></textarea>
  <br>
  <button onclick="getRecommendations()">Get Recommendations</button>
  <div id="results"></div>
  <script>
    async function getRecommendations() {
      const query = document.getElementById('query').value.trim();
      if (!query) { alert('Please enter a query.'); return; }
      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = '<p class="loading">Finding best assessments...</p>';
      try {
        const response = await fetch('/recommend', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ query: query, top_n: 10 })
        });
        const data = await response.json();
        const assessments = data.recommended_assessments;
        if (!assessments || assessments.length === 0) {
          resultsDiv.innerHTML = '<p>No assessments found.</p>';
          return;
        }
        let html = `<h2>Top ${assessments.length} Recommended Assessments</h2>`;
        assessments.forEach((a, i) => {
          const types = (a.test_type || []).map(t => `<span class="tag">${t}</span>`).join('');
          const duration = a.duration ? `${a.duration} min` : 'N/A';
          html += `
            <div class="card">
              <h3>${i + 1}. <a href="${a.url}" target="_blank">${a.name}</a></h3>
              <p>${a.description || ''}</p>
              <p>
                ${types}
                <span class="tag">‚è± ${duration}</span>
                <span class="tag">Remote: ${a.remote_support}</span>
                <span class="tag">Adaptive: ${a.adaptive_support}</span>
              </p>
            </div>`;
        });
        resultsDiv.innerHTML = html;
      } catch (err) {
        resultsDiv.innerHTML = `<p style="color:red">Error: ${err.message}</p>`;
      }
    }
  </script>
</body>
</html>
